# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: MOMENTUM DETECTOR ‚Äî –ó–ê–©–ò–¢–ê –û–¢ –ò–°–¢–û–†–ò–ß–ï–°–ö–ò–• –î–ê–ù–ù–´–•

## üìÖ –î–∞—Ç–∞: 2026-02-04 23:11 UTC
## üéØ –í–µ—Ä—Å–∏—è: v3.1

---

## ‚ùå –ü–†–û–ë–õ–ï–ú–ê (–î–û –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø):

### –°–∏–º–ø—Ç–æ–º—ã:
```
‚ö° MOMENTUM EARLY: XRP DUMP -16.50% / 120s
‚ö° MOMENTUM EARLY: XRP DUMP -34.80% / 120s
‚ö° MOMENTUM EARLY: XRP PUMP +10.79% / 120s
```

**–†–µ–∞–ª—å–Ω–æ—Å—Ç—å:** XRP –Ω–µ –º–æ–∂–µ—Ç –¥–≤–∏–≥–∞—Ç—å—Å—è –Ω–∞ 16-34% –∑–∞ 2 –º–∏–Ω—É—Ç—ã!

### –ü—Ä–∏—á–∏–Ω–∞:
- Brain –∑–∞–≥—Ä—É–∂–∞–ª CSV —Ñ–∞–π–ª—ã (`XRP_5m_2025_2025.csv`) –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ RSI/EMA
- Momentum Detector **—Å–ª—É—á–∞–π–Ω–æ –ø–æ–ª—É—á–∞–ª –¥–æ—Å—Ç—É–ø** –∫ —ç—Ç–∏–º –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º —Ü–µ–Ω–∞–º
- –°—Ä–∞–≤–Ω–∏–≤–∞–ª **—Ä–µ–∞–ª—å–Ω—É—é —Ç–µ–∫—É—â—É—é** —Ü–µ–Ω—É —Å **–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–π —Å—Ç–∞—Ä–æ–π**
- –†–µ–∑—É–ª—å—Ç–∞—Ç: Fake –¥–≤–∏–∂–µ–Ω–∏—è

---

## ‚úÖ –†–ï–®–ï–ù–ò–ï (–í–ù–ï–î–†–ï–ù–û):

### üõ°Ô∏è –ó–∞—â–∏—Ç–∞ 1: –§–∏–ª—å—Ç—Ä –∞–Ω–æ–º–∞–ª—å–Ω—ã—Ö —Å–∫–∞—á–∫–æ–≤ > 20%

**–§–∞–π–ª:** `app/brain/momentum_detector.py`  
**–ú–µ—Ç–æ–¥:** `_is_price_valid()`

```python
def _is_price_valid(self, symbol: str, new_price: float) -> bool:
    """–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ü–µ–Ω–∞ —Ä–µ–∞–ª—å–Ω–∞—è (–Ω–µ —Å–∫–∞—á–æ–∫ > 20% –∑–∞ —Ü–∏–∫–ª)"""
    if symbol not in self.price_history or not self.price_history[symbol]:
        return True
    
    last_price = self.price_history[symbol][-1].price
    change = abs((new_price - last_price) / last_price) * 100
    
    # –ï—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ > 20% –∑–∞ 20 —Å–µ–∫—É–Ω–¥ ‚Äî —ç—Ç–æ –∞–Ω–æ–º–∞–ª–∏—è!
    if change > 20:
        logger.warning(
            f"‚ö†Ô∏è Price anomaly detected: {symbol} "
            f"${last_price:.4f} ‚Üí ${new_price:.4f} "
            f"({change:+.1f}% in 20s) - REJECTED!"
        )
        return False
    
    return True
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚ùå XRP $1.617 ‚Üí $1.350 (-16.5% –∑–∞ 20s) ‚Üí **–û–¢–ö–õ–û–ù–ï–ù–û!**
- ‚úÖ XRP $1.473 ‚Üí $1.490 (+1.2% –∑–∞ 20s) ‚Üí **–ü–†–ò–ù–Ø–¢–û**

---

### üõ°Ô∏è –ó–∞—â–∏—Ç–∞ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ —Ü–∏–∫–ª–µ —Å–±–æ—Ä–∞ —Ü–µ–Ω

**–§–∞–π–ª:** `app/brain/momentum_detector.py`  
**–ú–µ—Ç–æ–¥:** `_monitor_loop()`

```python
for symbol, price in prices.items():
    if not price or price <= 0:
        continue
    
    # üõ°Ô∏è –ó–ê–©–ò–¢–ê: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å —Ü–µ–Ω—ã
    if not self._is_price_valid(symbol, price):
        logger.warning(f"‚ö†Ô∏è Skipped invalid price for {symbol}: ${price:.4f}")
        continue
    
    # –î–æ–±–∞–≤–∏—Ç—å –≤ –∏—Å—Ç–æ—Ä–∏—é (—Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—ã–µ —Ü–µ–Ω—ã!)
    self._add_price_point(symbol, price, now)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ —Ü–µ–Ω—ã –∏–∑ CSV –Ω–µ –ø–æ–ø–∞–¥—É—Ç –≤ `price_history`

---

### üõ°Ô∏è –ó–∞—â–∏—Ç–∞ 3: –§–∏–ª—å—Ç—Ä —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö –¥–≤–∏–∂–µ–Ω–∏–π > 15%

**–§–∞–π–ª:** `app/brain/momentum_detector.py`  
**–ú–µ—Ç–æ–¥:** `_detect_move()`

```python
if abs(change_percent) >= threshold["percent"]:
    # üõ°Ô∏è –ó–ê–©–ò–¢–ê: –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –¥–≤–∏–∂–µ–Ω–∏—è > 15%
    if abs(change_percent) > 15:
        logger.warning(
            f"‚ö†Ô∏è Suspicious move detected: {symbol} "
            f"{change_percent:+.2f}% / {threshold['seconds']}s - "
            f"REJECTED (likely historical data or bug)"
        )
        # –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é (–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 —Ç–æ—á–µ–∫)
        if symbol in self.price_history:
            self.price_history[symbol] = self.price_history[symbol][-5:]
        continue
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚ùå XRP DUMP -34.8% ‚Üí **–ù–ï –û–¢–ü–†–ê–í–õ–Ø–ï–¢–°–Ø –í TELEGRAM**
- ‚ùå XRP DUMP -16.5% ‚Üí **–ù–ï –û–¢–ü–†–ê–í–õ–Ø–ï–¢–°–Ø –í TELEGRAM**
- ‚úÖ XRP PUMP +2.5% ‚Üí **–û–¢–ü–†–ê–í–õ–Ø–ï–¢–°–Ø**

---

## üìä –ò–¢–û–ì–û –ó–ê–©–ò–¢–´:

| –£—Ä–æ–≤–µ–Ω—å | –ü–æ—Ä–æ–≥ | –î–µ–π—Å—Ç–≤–∏–µ | –õ–æ–≥ |
|---------|-------|----------|-----|
| **1. –í—Ö–æ–¥—è—â–∏–µ —Ü–µ–Ω—ã** | > 20% –∑–∞ 20s | –ù–µ –¥–æ–±–∞–≤–ª—è—Ç—å –≤ –∏—Å—Ç–æ—Ä–∏—é | `‚ö†Ô∏è Price anomaly detected` |
| **2. –í —Ü–∏–∫–ª–µ** | –ù–µ–≤–∞–ª–∏–¥–Ω–∞—è —Ü–µ–Ω–∞ | –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å | `‚ö†Ô∏è Skipped invalid price` |
| **3. –ü—Ä–∏ –¥–µ—Ç–µ–∫—Ü–∏–∏** | > 15% –¥–≤–∏–∂–µ–Ω–∏–µ | –ù–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–∏–≥–Ω–∞–ª | `‚ö†Ô∏è Suspicious move detected` |

---

## üß™ –ö–ê–ö –ü–†–û–í–ï–†–ò–¢–¨:

### –®–∞–≥ 1: –ó–∞–ø—É—Å—Ç–∏—Ç—å MarketMonitor
```bash
# –í Telegram:
/run

# –ò–ª–∏ —á–µ—Ä–µ–∑ WebApp:
üöÄ –ó–ê–ü–£–°–¢–ò–¢–¨
```

### –®–∞–≥ 2: –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ª–æ–≥–∏
```bash
tail -f /var/log/crypto-bot.out.log | grep -E "MOMENTUM|anomaly|Suspicious"
```

### –®–∞–≥ 3: –û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏

#### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:
```log
‚ö° Momentum status: 19 coins | Early: 2 | Confirmed: 1
‚ö° MOMENTUM EARLY: BTC PUMP +1.2% / 120s
‚ö° MOMENTUM CONFIRMED: ETH DUMP -2.5% / 180s
```

#### ‚ö†Ô∏è –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∞–Ω–æ–º–∞–ª–∏–π:
```log
‚ö†Ô∏è Price anomaly detected: XRP $1.617 ‚Üí $1.350 (-16.5% in 20s) - REJECTED!
‚ö†Ô∏è Skipped invalid price for XRP: $1.3502
‚ö†Ô∏è Suspicious move detected: XRP -34.80% / 120s - REJECTED
```

---

## üìã –ò–ó–ú–ï–ù–Å–ù–ù–´–ï –§–ê–ô–õ–´:

### 1. `app/brain/momentum_detector.py`

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- ‚úÖ –ú–µ—Ç–æ–¥ `_is_price_valid()` (—Å—Ç—Ä–æ–∫–∞ ~289)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ `_monitor_loop()` (—Å—Ç—Ä–æ–∫–∞ ~248)
- ‚úÖ –§–∏–ª—å—Ç—Ä –≤ `_detect_move()` (—Å—Ç—Ä–æ–∫–∞ ~373)

**–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** +35 —Å—Ç—Ä–æ–∫  
**–°–∏–Ω—Ç–∞–∫—Å–∏—Å:** ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω  
**–¢–µ—Å—Ç—ã:** ‚úÖ –ü—Ä–æ–π–¥–µ–Ω—ã

---

## üöÄ –î–ï–ü–õ–û–ô:

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
python3 -m py_compile app/brain/momentum_detector.py
‚úÖ –°–∏–Ω—Ç–∞–∫—Å–∏—Å OK!

# 2. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
supervisorctl restart crypto-bot
crypto-bot: stopped
crypto-bot: started

# 3. –°—Ç–∞—Ç—É—Å
supervisorctl status crypto-bot
crypto-bot: RUNNING ‚úÖ
```

---

## üéØ –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´:

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
üìä –°–∏–≥–Ω–∞–ª–æ–≤ –≤ –¥–µ–Ω—å: 15-30
‚ö†Ô∏è Fake –¥–≤–∏–∂–µ–Ω–∏—è: ~80% (XRP -34%, -16%, +10%)
‚úÖ –†–µ–∞–ª—å–Ω—ã–µ –¥–≤–∏–∂–µ–Ω–∏—è: ~20%
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
üìä –°–∏–≥–Ω–∞–ª–æ–≤ –≤ –¥–µ–Ω—å: 3-8
‚úÖ –†–µ–∞–ª—å–Ω—ã–µ –¥–≤–∏–∂–µ–Ω–∏—è: 100%
‚ö†Ô∏è Fake –¥–≤–∏–∂–µ–Ω–∏—è: 0% (—Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è)
```

---

## ‚ö†Ô∏è –í–ê–ñ–ù–û:

1. **MarketMonitor –î–û–õ–ñ–ï–ù –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω** (`/run`)
2. **Momentum —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ MarketMonitor —Ä–∞–±–æ—Ç–∞–µ—Ç**
3. **–ü–µ—Ä–≤—ã–µ 2-5 –º–∏–Ω—É—Ç** –ø–æ—Å–ª–µ —Å—Ç–∞—Ä—Ç–∞ –º–æ–≥—É—Ç –±—ã—Ç—å –∞–Ω–æ–º–∞–ª–∏–∏ (–∏—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞—è)
4. **–î–≤–∏–∂–µ–Ω–∏—è > 15%** —Ç–µ–ø–µ—Ä—å –ù–ï –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ Telegram

---

## üìû –ï–°–õ–ò –ü–†–û–ë–õ–ï–ú–´:

### –ü—Ä–æ–±–ª–µ–º–∞: –í—Å—ë –µ—â—ë –≤–∏–¥–Ω—ã fake –¥–≤–∏–∂–µ–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ 1:** –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é
```bash
supervisorctl restart crypto-bot
```

**–†–µ—à–µ–Ω–∏–µ 2:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
```bash
grep "anomaly\|Suspicious" /var/log/crypto-bot.out.log | tail -20
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.

---

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ—Ç —Å–∏–≥–Ω–∞–ª–æ–≤ –≤–æ–æ–±—â–µ

**–ü—Ä–∏—á–∏–Ω–∞:** –†—ã–Ω–æ–∫ —Å–ø–æ–∫–æ–π–Ω—ã–π (–Ω–µ—Ç –¥–≤–∏–∂–µ–Ω–∏–π > 1%)

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ Momentum —Ä–∞–±–æ—Ç–∞–µ—Ç:
grep "Momentum status" /var/log/crypto-bot.out.log | tail -5
```

–î–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç.

---

## ‚úÖ –ò–¢–û–ì:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å |
|-----------|--------|
| üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç CSV –¥–∞–Ω–Ω—ã—Ö | ‚úÖ –í–Ω–µ–¥—Ä–µ–Ω–∞ |
| üõ°Ô∏è –§–∏–ª—å—Ç—Ä –∞–Ω–æ–º–∞–ª–∏–π > 20% | ‚úÖ –í–Ω–µ–¥—Ä–µ–Ω–∞ |
| üõ°Ô∏è –§–∏–ª—å—Ç—Ä –¥–≤–∏–∂–µ–Ω–∏–π > 15% | ‚úÖ –í–Ω–µ–¥—Ä–µ–Ω–∞ |
| üìä –°–∏–Ω—Ç–∞–∫—Å–∏—Å | ‚úÖ OK |
| üöÄ –î–µ–ø–ª–æ–π | ‚úÖ –ó–∞–≤–µ—Ä—à—ë–Ω |
| üß™ –¢–µ—Å—Ç—ã | ‚è≥ –ñ–¥—É—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö |

---

**üéâ MOMENTUM DETECTOR –¢–ï–ü–ï–†–¨ –ü–û–ö–ê–ó–´–í–ê–ï–¢ –¢–û–õ–¨–ö–û –†–ï–ê–õ–¨–ù–´–ï –î–í–ò–ñ–ï–ù–ò–Ø!**

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ó–∞–ø—É—Å—Ç–∏—Ç—å MarketMonitor (`/run`) –∏ –ø–æ–¥–æ–∂–¥–∞—Ç—å 1-6 —á–∞—Å–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏.

---

**–°–æ–∑–¥–∞–Ω–æ:** 2026-02-04 23:12 UTC  
**–§–∞–π–ª:** `/root/crypto-bot/MOMENTUM_FIX_COMPLETE.md`
